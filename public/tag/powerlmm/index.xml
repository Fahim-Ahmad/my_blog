<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>powerlmm | Fahim Ahmad</title>
    <link>/tag/powerlmm/</link>
      <atom:link href="/tag/powerlmm/index.xml" rel="self" type="application/rss+xml" />
    <description>powerlmm</description>
    <generator>Wowchemy (https://wowchemy.com)</generator><language>en-us</language><copyright>© Fahim Ahmad (2020)</copyright><lastBuildDate>Fri, 02 Jul 2021 00:00:00 +0000</lastBuildDate>
    <image>
      <url>/media/icon_hua2ec155b4296a9c9791d015323e16eb5_11927_512x512_fill_lanczos_center_2.png</url>
      <title>powerlmm</title>
      <link>/tag/powerlmm/</link>
    </image>
    
    <item>
      <title>Example power analysis report</title>
      <link>/post/2021-07-02-example-power-analysis-report/</link>
      <pubDate>Fri, 02 Jul 2021 00:00:00 +0000</pubDate>
      <guid>/post/2021-07-02-example-power-analysis-report/</guid>
      <description>
&lt;script src=&#34;/post/2021-07-02-example-power-analysis-report/index_files/header-attrs/header-attrs.js&#34;&gt;&lt;/script&gt;


&lt;div id=&#34;context&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Context&lt;/h2&gt;
&lt;p&gt;In one of my recent Twitter posts, I got pissy and complained about a vague power-analysis statement I saw while reviewing a manuscript submitted to a scientific journal.&lt;/p&gt;
&lt;p&gt;&lt;blockquote class=&#34;twitter-tweet&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;If you submit a manuscript for publication that involves HLMs and SEMs of longitudinal data and you vaguely summarize your power analysis in one sentence, I, as your friendly neighborhood Reviewer #2, am requesting a full power-analysis write-up as a supplementary material.&lt;/p&gt;&amp;mdash; Solomon Kurz (@SolomonKurz) &lt;a href=&#34;https://twitter.com/SolomonKurz/status/1409626961161371648?ref_src=twsrc%5Etfw&#34;&gt;June 28, 2021&lt;/a&gt;&lt;/blockquote&gt;
&lt;script async src=&#34;https://platform.twitter.com/widgets.js&#34; charset=&#34;utf-8&#34;&gt;&lt;/script&gt;
&lt;/p&gt;
&lt;p&gt;It wasn’t my best moment and I ended up apologizing for my tone.&lt;/p&gt;
&lt;p&gt;&lt;blockquote class=&#34;twitter-tweet&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;Okay, I apologize for getting a little pissy with the tweet. Yet the issue is real and it leads to a natural question: What would go into a good power analysis report? I’ve done a few for work and I promise to morph one into a blog post, by the end of the week.&lt;/p&gt;&amp;mdash; Solomon Kurz (@SolomonKurz) &lt;a href=&#34;https://twitter.com/SolomonKurz/status/1409634560485199876?ref_src=twsrc%5Etfw&#34;&gt;June 28, 2021&lt;/a&gt;&lt;/blockquote&gt;
&lt;script async src=&#34;https://platform.twitter.com/widgets.js&#34; charset=&#34;utf-8&#34;&gt;&lt;/script&gt;
&lt;/p&gt;
&lt;p&gt;However, the broader issue remains. If you plan to analyze your data with anything more complicated than a &lt;span class=&#34;math inline&#34;&gt;\(t\)&lt;/span&gt;-test, the power analysis phase gets tricky. The manuscript I was complaining about used a complicated multilevel model as its primary analysis. I’m willing to bet that most applied researchers (including the authors of that manuscript) have never done a power analysis for a multilevel model and probably have never seen what one might look like, either. The purpose of this post is to give a real-world example of just such an analysis.&lt;/p&gt;
&lt;p&gt;Over the past couple years, I’ve done a few multilevel power analyses as part of my day job. In this post, I will reproduce one of them. For the sake of confidentiality, some of the original content will be omitted or slightly altered. But the overall workflow will be about 90% faithful to the original report I submitted to my boss. To understand this report, you should know:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;my boss has some experience fitting multilevel models, but they’re not a stats jock;&lt;/li&gt;
&lt;li&gt;we had pilot data from two different sources, each with its strengths and weaknesses; and&lt;/li&gt;
&lt;li&gt;this document was meant for internal purposes only, though I believe some of its contents did make it into other materials.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;At the end, I’ll wrap this post up with a few comments. Here’s the report:&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;executive-summary&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Executive summary&lt;/h2&gt;
&lt;p&gt;A total sample size of &lt;strong&gt;164&lt;/strong&gt; is the minimum number to detect an effect size similar to that in the pilot data (i.e., Cohen’s &lt;span class=&#34;math inline&#34;&gt;\(d = 0.3\)&lt;/span&gt;). This recommendation assumes&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;a study design of three time points,&lt;/li&gt;
&lt;li&gt;random assignment of participants into two equal groups, and&lt;/li&gt;
&lt;li&gt;20% dropout on the second time point and another 20% dropout by the third time point.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;If we presume a more conservative effect size of &lt;span class=&#34;math inline&#34;&gt;\(0.2\)&lt;/span&gt; and a larger dropout rate of 30% the second and third time points, the minimum recommended total sample size is &lt;strong&gt;486&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;The remainder of this report details how I came to these conclusions. For full transparency, I will supplement prose with figures, tables, and the statistical code used used for all computations. By default, the code is hidden is this document. However, if you are interested in the code, you should be able to make it appear by selecting “Show All Code” in the dropdown menu from the “Code” button on the upper-right corner.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;cohens-d&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Cohen’s &lt;span class=&#34;math inline&#34;&gt;\(d\)&lt;/span&gt;&lt;/h2&gt;
&lt;p&gt;In this report, Cohen’s &lt;span class=&#34;math inline&#34;&gt;\(d\)&lt;/span&gt; is meant to indicate a standardized mean difference. The &lt;span class=&#34;math inline&#34;&gt;\(d = 0.3\)&lt;/span&gt; from above is based on the &lt;code&gt;some_file.docx&lt;/code&gt; file you shared with me last week. In Table 1, you provided the following summary information for the intervention group:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(tidyverse)

tibble(summary = c(&amp;quot;mean&amp;quot;, &amp;quot;sd&amp;quot;),
       baseline = c(1.29, 1.13),
       followup = c(0.95, 1.09)) %&amp;gt;% 
  knitr::kable()&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;summary&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;baseline&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;followup&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;mean&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.29&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.95&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;sd&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.13&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.09&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;With that information, we can compute a within-subject’s &lt;span class=&#34;math inline&#34;&gt;\(d\)&lt;/span&gt; by hand. With this formula, we will be using the pooled standard deviation in the denominator.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;d &amp;lt;- (1.29 - .95) / sqrt((1.13^2 + 1.09^2) / 2)
d&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 0.3062566&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;However, 0.306 is just a point estimate. We can express the uncertainty in that point estimate with 95% confidence intervals.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;ci &amp;lt;-
  MBESS::ci.smd(smd = d,
                n.1 = 50, 
                n.2 = 26)

ci %&amp;gt;% 
  data.frame() %&amp;gt;% 
  glimpse()&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Rows: 1
## Columns: 3
## $ Lower.Conf.Limit.smd &amp;lt;dbl&amp;gt; -0.1712149
## $ smd                  &amp;lt;dbl&amp;gt; 0.3062566
## $ Upper.Conf.Limit.smd &amp;lt;dbl&amp;gt; 0.7816834&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;In this output, &lt;code&gt;smd&lt;/code&gt; refers to “standardized mean difference,” what what we have been referring to as Cohen’s &lt;span class=&#34;math inline&#34;&gt;\(d\)&lt;/span&gt;. The output indicates the effect size for the experimental group from the pilot study was &lt;span class=&#34;math inline&#34;&gt;\(d\)&lt;/span&gt; of 0.31 [-0.17, .78]. The data look promising for a small/moderate effect. But those confidence intervals swing from small negative to large.&lt;/p&gt;
&lt;p&gt;For reference, here are the 50% intervals.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;MBESS::ci.smd(smd = d,
              n.1 = 50, 
              n.2 = 26,
              conf.level = .5) %&amp;gt;% 
  data.frame() %&amp;gt;% 
  glimpse()&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Rows: 1
## Columns: 3
## $ Lower.Conf.Limit.smd &amp;lt;dbl&amp;gt; 0.1412595
## $ smd                  &amp;lt;dbl&amp;gt; 0.3062566
## $ Upper.Conf.Limit.smd &amp;lt;dbl&amp;gt; 0.4691839&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The 50% CIs range from 0.14 to 0.47.&lt;/p&gt;
&lt;div id=&#34;power-analyses-can-be-tailor-made.&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Power analyses can be tailor made.&lt;/h3&gt;
&lt;p&gt;Whenever possible, it is preferable to tailor a power analysis to the statistical models researchers plan to use to analyze the data they intend to collect. Based on your previous analyses, I suspect you intend to fit a series of hierarchical models. I would have done the same thing with those data and I further recommend you analyze the data you intend to collect within a hierarchical growth model paradigm. With that in mind, the power analyses in the report are all based on the following model:&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[\begin{align*}
y_{ij} &amp;amp; = \beta_{0i} + \beta_{1i} \text{time}_{ij} + \epsilon_{ij} \\
\beta_{0i} &amp;amp; = \gamma_{00} + \gamma_{01} \text{treatment}_i +  u_{0i} \\
\beta_{1i} &amp;amp; = \gamma_{10} + \gamma_{11} \text{treatment}_i +  u_{1i}, 
\end{align*}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;where &lt;span class=&#34;math inline&#34;&gt;\(y\)&lt;/span&gt; is the dependent variable of interest, which varies across &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; participants and &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; measurement occasions. The model is linear with an intercept &lt;span class=&#34;math inline&#34;&gt;\(\beta_{0i}\)&lt;/span&gt; and slope &lt;span class=&#34;math inline&#34;&gt;\(\beta_{1i}\)&lt;/span&gt;. As indicated by the &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; subscripts, both intercepts and slopes vary across participants with grand means &lt;span class=&#34;math inline&#34;&gt;\(\gamma_{00}\)&lt;/span&gt; and &lt;span class=&#34;math inline&#34;&gt;\(\gamma_{10}\)&lt;/span&gt;, respectively, and participant-specific deviations around those means &lt;span class=&#34;math inline&#34;&gt;\(u_{0i}\)&lt;/span&gt; and &lt;span class=&#34;math inline&#34;&gt;\(u_{1i}\)&lt;/span&gt;, respectively. There is a focal between-participant predictor in the model, &lt;span class=&#34;math inline&#34;&gt;\(\text{treatment}_i\)&lt;/span&gt;, which is coded 0 = &lt;em&gt;control&lt;/em&gt; 1 = &lt;em&gt;treatment&lt;/em&gt;. Rearranging the the formulas into the composite form will make it clear this is an interaction model:&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[\begin{align*}
y_{ij} &amp;amp; = \gamma_{00} + \gamma_{01} \text{treatment}_i \\
       &amp;amp; \;\;\; + \gamma_{10} \text{time}_{ij} + \gamma_{11} \text{treatment}_i \times \text{time}_{ij} \\
       &amp;amp; \;\;\; + u_{0i} +  u_{1i} \text{time}_{ij} + \epsilon_{ij},
\end{align*}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;where the parameter of primary interest for the study is &lt;span class=&#34;math inline&#34;&gt;\(\gamma_{11} \text{treatment}_i \times \text{time}_{ij}\)&lt;/span&gt;, the difference between the two &lt;span class=&#34;math inline&#34;&gt;\(\text{treatment}\)&lt;/span&gt; conditions in their change in &lt;span class=&#34;math inline&#34;&gt;\(y\)&lt;/span&gt; over &lt;span class=&#34;math inline&#34;&gt;\(\text{time}\)&lt;/span&gt;. As such, the focus of the power analyses reported above are on the power to reject the null hypothesis the &lt;span class=&#34;math inline&#34;&gt;\(\text{treatment}\)&lt;/span&gt; conditions do not differ in their change over &lt;span class=&#34;math inline&#34;&gt;\(\text{time}\)&lt;/span&gt;,&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[H_0: \gamma_{11} = 0.\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;To finish out the equations, this approach makes the typical assumptions the within-participant residual term, &lt;span class=&#34;math inline&#34;&gt;\(\epsilon_{ij}\)&lt;/span&gt;, is normally distributed around zero,&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[\epsilon_{ij} \sim \operatorname{Normal} (0, \sigma_\epsilon^2),\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;and the between-participant variances &lt;span class=&#34;math inline&#34;&gt;\(u_{0i}\)&lt;/span&gt; and &lt;span class=&#34;math inline&#34;&gt;\(u_{1i}\)&lt;/span&gt; have a multivariate normal distribution with a mean vector of zeros,&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[\begin{bmatrix} u_{0i} \\ u_{1i} \end{bmatrix} \sim \operatorname{Normal} \Bigg ( \begin{bmatrix} 0 \\ 0 \end{bmatrix}, \begin{bmatrix} \sigma_0^2 &amp;amp; \sigma_{01} \\ \sigma_{01} &amp;amp; \sigma_1^2 \end{bmatrix} \Bigg ).\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Following convention, the within-participant residuals &lt;span class=&#34;math inline&#34;&gt;\(\epsilon_{ij}\)&lt;/span&gt; are orthogonal to the between-participant variances &lt;span class=&#34;math inline&#34;&gt;\(u_{0i}\)&lt;/span&gt; and &lt;span class=&#34;math inline&#34;&gt;\(u_{1i}\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;For simplicity, another assumption of this model that the control condition will remain constant over time.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;main-results-power-curves.&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Main results: Power curves.&lt;/h3&gt;
&lt;p&gt;I computed a series of power curves to examine the necessary sample size given different assumptions. Due to the uncertainty in the effect size from the pilot data, &lt;span class=&#34;math inline&#34;&gt;\(d = 0.31 [-0.17, .78]\)&lt;/span&gt;, varied the effect size from 0.1 to 0.3. I also examined different levels of missing data via dropout. These followed four patterns of dropout and were extensions of the missing data pattern described in the &lt;code&gt;some_other_file.docx&lt;/code&gt; file. They were:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;tibble(`dropout rate` = str_c(c(0, 10, 20, 30), &amp;quot;%&amp;quot;),
       baseline = &amp;quot;100%&amp;quot;,
       `1st followup` = str_c(c(100, 90, 80, 70), &amp;quot;%&amp;quot;),
       `2nd followup` = str_c(c(100, 80, 60, 40), &amp;quot;%&amp;quot;)) %&amp;gt;% 
  knitr::kable()&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;dropout rate&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;baseline&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;1st followup&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;2nd followup&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;0%&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;100%&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;100%&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;100%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;10%&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;100%&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;90%&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;80%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;20%&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;100%&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;80%&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;60%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;30%&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;100%&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;70%&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;40%&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;The row with the 20% dropout rate, for example, corresponds directly to the dropout rate entertained in the &lt;code&gt;some_other_file.docx&lt;/code&gt; file.&lt;/p&gt;
&lt;p&gt;The power simulations of this kind required two more bits of information. The first was that we specify an expected intraclass correlation coefficient (ICC). I used ICC = .9, which is the ICC value you reported in your previous work (p. 41).&lt;/p&gt;
&lt;p&gt;The second value needed is the ratio of &lt;span class=&#34;math inline&#34;&gt;\(u_{1i}/ \epsilon_{ij}\)&lt;/span&gt;, sometimes called the “variance ratio.” I was not able to determine that value from the &lt;code&gt;some_file.docx&lt;/code&gt; or the &lt;code&gt;some_other_file.docx&lt;/code&gt;. However, I was able to compute one based on data from a different project on participants from a similar population. The data are from several hundred participants in a longitudinal survey study. The data do not include your primary variable of interest. Instead, I took the &lt;span class=&#34;math inline&#34;&gt;\(u_{1i}/ \epsilon_{ij}\)&lt;/span&gt; from recent hierarchical analyses of two related measures. These left me with two values: 0.018 on the low end and 0.281 on the high end. Thus, I performed the power curves using both.&lt;/p&gt;
&lt;p&gt;Here is the code for the simulations:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(powerlmm)

t &amp;lt;- 3
n &amp;lt;- 100

# variance ratio 0.018
icc0.9_vr_0.018_d0.1 &amp;lt;-
  study_parameters(n1 = t,
                 n2 = n,
                 icc_pre_subject = 0.9,
                  var_ratio = 0.018,
                  effect_size = cohend(-0.2, 
                                       standardizer = &amp;quot;pretest_SD&amp;quot;),
                 dropout = dropout_manual(0, 0.1, 0.2)) %&amp;gt;% 
  get_power_table(n2 = 25:500,
                  effect_size = cohend(c(.1, .15, .2, .25, .3), 
                                       standardizer = &amp;quot;pretest_SD&amp;quot;))

icc0.9_vr_0.018_d0.2 &amp;lt;-
  study_parameters(n1 = t,
                 n2 = n,
                 icc_pre_subject = 0.9,
                  var_ratio = 0.018,
                  effect_size = cohend(-0.2, 
                                       standardizer = &amp;quot;pretest_SD&amp;quot;),
                 dropout = dropout_manual(0, 0.2, 0.4)) %&amp;gt;% 
  get_power_table(n2 = 25:500,
                  effect_size = cohend(c(.1, .15, .2, .25, .3), 
                                       standardizer = &amp;quot;pretest_SD&amp;quot;))

icc0.9_vr_0.018_d0.3 &amp;lt;-
  study_parameters(n1 = t,
                 n2 = n,
                 icc_pre_subject = 0.9,
                  var_ratio = 0.018,
                  effect_size = cohend(-0.2, 
                                       standardizer = &amp;quot;pretest_SD&amp;quot;),
                 dropout = dropout_manual(0, 0.3, 0.6)) %&amp;gt;% 
  get_power_table(n2 = 25:500,
                  effect_size = cohend(c(.1, .15, .2, .25, .3), 
                                       standardizer = &amp;quot;pretest_SD&amp;quot;))

# variance ratio 0.281
icc0.9_vr_0.281_d0.1 &amp;lt;-
  study_parameters(n1 = t,
                 n2 = n,
                 icc_pre_subject = 0.9,
                  var_ratio = 0.281,
                  effect_size = cohend(-0.2, 
                                       standardizer = &amp;quot;pretest_SD&amp;quot;),
                 dropout = dropout_manual(0, 0.1, 0.2)) %&amp;gt;% 
  get_power_table(n2 = 25:500,
                  effect_size = cohend(c(.1, .15, .2, .25, .3), 
                                       standardizer = &amp;quot;pretest_SD&amp;quot;))

icc0.9_vr_0.281_d0.2 &amp;lt;-
  study_parameters(n1 = t,
                 n2 = n,
                 icc_pre_subject = 0.9,
                  var_ratio = 0.281,
                  effect_size = cohend(-0.2, 
                                       standardizer = &amp;quot;pretest_SD&amp;quot;),
                 dropout = dropout_manual(0, 0.2, 0.4)) %&amp;gt;% 
  get_power_table(n2 = 25:500,
                  effect_size = cohend(c(.1, .15, .2, .25, .3), 
                                       standardizer = &amp;quot;pretest_SD&amp;quot;))

icc0.9_vr_0.281_d0.3 &amp;lt;-
  study_parameters(n1 = t,
                 n2 = n,
                 icc_pre_subject = 0.9,
                  var_ratio = 0.281,
                  effect_size = cohend(-0.2, 
                                       standardizer = &amp;quot;pretest_SD&amp;quot;),
                 dropout = dropout_manual(0, 0.3, 0.6)) %&amp;gt;% 
  get_power_table(n2 = 25:500,
                  effect_size = cohend(c(.1, .15, .2, .25, .3), 
                                       standardizer = &amp;quot;pretest_SD&amp;quot;))&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Here are the power curve plots, beginning with the plot for the smaller variance ratio of 0.018.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;bind_rows(
  icc0.9_vr_0.018_d0.1 %&amp;gt;% filter(dropout == &amp;quot;with missing&amp;quot;),
  icc0.9_vr_0.018_d0.2 %&amp;gt;% filter(dropout == &amp;quot;with missing&amp;quot;),
  icc0.9_vr_0.018_d0.3
) %&amp;gt;% 
  mutate(missing = c(rep(str_c(c(10, 20, 30, 00), &amp;quot;% missing per time point after baseline&amp;quot;), each = n() / 4))) %&amp;gt;% 
  
  mutate(d = factor(effect_size,
                    levels = c(&amp;quot;0.1&amp;quot;, &amp;quot;0.15&amp;quot;, &amp;quot;0.2&amp;quot;, &amp;quot;0.25&amp;quot;, &amp;quot;0.3&amp;quot;),
                    labels = c(&amp;quot;.10&amp;quot;, &amp;quot;.15&amp;quot;, &amp;quot;.20&amp;quot;, &amp;quot;.25&amp;quot;, &amp;quot;.30&amp;quot;))) %&amp;gt;% 
  mutate(d = fct_rev(d)) %&amp;gt;% 
  
  ggplot(aes(x = tot_n, y = power, color = d)) +
  geom_vline(xintercept = 500, color = &amp;quot;white&amp;quot;, size = 1) +
  geom_hline(yintercept = .8, color = &amp;quot;white&amp;quot;, size = 1) +
  geom_line(size = 1.5) +
  scale_color_viridis_d(expression(paste(&amp;quot;Cohen&amp;#39;s &amp;quot;, italic(d))),
                        option = &amp;quot;A&amp;quot;, end = .67, direction = -1) +
  scale_x_continuous(expression(paste(italic(N), &amp;quot; (i.e., the total sample size)&amp;quot;)), 
                     breaks = seq(from = 0, to = 1000, by = 100), limits = c(0, 1000)) +
  scale_y_continuous(breaks = c(0, .2, .4, .6, .8, 1), limits = c(0, 1)) +
  ggtitle(&amp;quot;Power curves based on a variance ratio of 0.018&amp;quot;) +
  theme(panel.grid.major.y = element_blank(),
        panel.grid.minor.y = element_blank()) +
  facet_wrap(~missing)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2021-07-02-example-power-analysis-report/index_files/figure-html/unnamed-chunk-10-1.png&#34; width=&#34;816&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Here is the power curve plot for the larger variance ratio of 0.281.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;bind_rows(
  icc0.9_vr_0.281_d0.1 %&amp;gt;% filter(dropout == &amp;quot;with missing&amp;quot;),
  icc0.9_vr_0.281_d0.2 %&amp;gt;% filter(dropout == &amp;quot;with missing&amp;quot;),
  icc0.9_vr_0.281_d0.3
) %&amp;gt;% 
  mutate(missing = c(rep(str_c(c(10, 20, 30, 00), &amp;quot;% missing per time point after baseline&amp;quot;), each = n() / 4))) %&amp;gt;% 
  
  mutate(d = factor(effect_size,
                    levels = c(&amp;quot;0.1&amp;quot;, &amp;quot;0.15&amp;quot;, &amp;quot;0.2&amp;quot;, &amp;quot;0.25&amp;quot;, &amp;quot;0.3&amp;quot;),
                    labels = c(&amp;quot;.10&amp;quot;, &amp;quot;.15&amp;quot;, &amp;quot;.20&amp;quot;, &amp;quot;.25&amp;quot;, &amp;quot;.30&amp;quot;))) %&amp;gt;% 
  mutate(d = fct_rev(d)) %&amp;gt;% 
  
  ggplot(aes(x = tot_n, y = power, color = d)) +
  geom_vline(xintercept = 500, color = &amp;quot;white&amp;quot;, size = 1) +
  geom_hline(yintercept = .8, color = &amp;quot;white&amp;quot;, size = 1) +
  geom_line(size = 1.5) +
  scale_color_viridis_d(expression(paste(&amp;quot;Cohen&amp;#39;s &amp;quot;, italic(d))),
                        option = &amp;quot;A&amp;quot;, end = .67, direction = -1) +
  scale_x_continuous(expression(paste(italic(N), &amp;quot; (i.e., the total sample size)&amp;quot;)), 
                     breaks = seq(from = 0, to = 1000, by = 100), limits = c(0, 1000)) +
  scale_y_continuous(breaks = c(0, .2, .4, .6, .8, 1), limits = c(0, 1)) +
  ggtitle(&amp;quot;Power curves based on a variance ratio of 0.281&amp;quot;) +
  theme(panel.grid.major.y = element_blank(),
        panel.grid.minor.y = element_blank()) +
  facet_wrap(~missing)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2021-07-02-example-power-analysis-report/index_files/figure-html/unnamed-chunk-11-1.png&#34; width=&#34;816&#34; /&gt;&lt;/p&gt;
&lt;p&gt;The upshot of the variance ratio issue is that a higher variance ratio led to lower power. To be on the safe side, &lt;em&gt;I recommend leaning on the more conservative power curve estimates from the simulations based on the larger variance ratio&lt;/em&gt;, &lt;strong&gt;0.281&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;A more succinct way to summarize the information in the power curves in with two tables. Here is the minimum total sample size required to reach a power of .8 based on the smaller evidence ratio of 0.018 and the various combinations of Cohen’s &lt;span class=&#34;math inline&#34;&gt;\(d\)&lt;/span&gt; and dropout:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;bind_rows(
  icc0.9_vr_0.018_d0.1 %&amp;gt;% filter(dropout == &amp;quot;with missing&amp;quot;),
  icc0.9_vr_0.018_d0.2 %&amp;gt;% filter(dropout == &amp;quot;with missing&amp;quot;),
  icc0.9_vr_0.018_d0.3
) %&amp;gt;% 
  mutate(missing = c(rep(c(10, 20, 30, 00), each = n() / 4))) %&amp;gt;% 

  filter(power &amp;gt; .8) %&amp;gt;% 
  group_by(missing, effect_size) %&amp;gt;% 
  top_n(-1, power) %&amp;gt;% 
  select(-n2, -power, -dropout) %&amp;gt;% 
  ungroup() %&amp;gt;% 
  mutate(`Cohen&amp;#39;s d` = effect_size) %&amp;gt;% 
  
  ggplot(aes(x = `Cohen&amp;#39;s d`, y = missing)) +
  geom_tile(aes(fill = tot_n),
            show.legend = F) +
  geom_text(aes(label = tot_n, color = tot_n &amp;lt; 700),
            show.legend = F) +
  scale_fill_viridis_c(option = &amp;quot;B&amp;quot;, begin = .1, end = .70 ,limits = c(0, 1000)) +
  scale_color_manual(values = c(&amp;quot;black&amp;quot;, &amp;quot;white&amp;quot;)) +
  labs(title = expression(paste(&amp;quot;Total &amp;quot;, italic(N), &amp;quot; required for .8 power, based on a variance ratio of 0.018&amp;quot;)),
       subtitle = expression(paste(&amp;quot;The power simulations only considered up to &amp;quot;, italic(N), &amp;quot; = 1,000.&amp;quot;)),
       x = expression(paste(&amp;quot;Cohen&amp;#39;s &amp;quot;, italic(d))),
       y = &amp;quot;% missing\nper follow-up&amp;quot;) +
  theme(axis.ticks = element_blank(),
        panel.grid = element_blank())&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2021-07-02-example-power-analysis-report/index_files/figure-html/unnamed-chunk-12-1.png&#34; width=&#34;624&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Here is an alternative version of that plot, this time based on the more conservative variance ratio of 0.281.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;bind_rows(
  icc0.9_vr_0.281_d0.1 %&amp;gt;% filter(dropout == &amp;quot;with missing&amp;quot;),
  icc0.9_vr_0.281_d0.2 %&amp;gt;% filter(dropout == &amp;quot;with missing&amp;quot;),
  icc0.9_vr_0.281_d0.3
) %&amp;gt;% 
  mutate(missing = c(rep(c(10, 20, 30, 00), each = n() / 4))) %&amp;gt;% 

  filter(power &amp;gt; .8) %&amp;gt;% 
  group_by(missing, effect_size) %&amp;gt;% 
  top_n(-1, power) %&amp;gt;% 
  select(-n2, -power, -dropout) %&amp;gt;% 
  ungroup() %&amp;gt;% 
  mutate(`Cohen&amp;#39;s d` = effect_size) %&amp;gt;% 
  
  ggplot(aes(x = `Cohen&amp;#39;s d`, y = missing)) +
  geom_tile(aes(fill = tot_n),
            show.legend = F) +
  geom_text(aes(label = tot_n, color = tot_n &amp;lt; 700),
            show.legend = F) +
  scale_fill_viridis_c(option = &amp;quot;B&amp;quot;, begin = .1, end = .70 ,limits = c(0, 1000)) +
  scale_color_manual(values = c(&amp;quot;black&amp;quot;, &amp;quot;white&amp;quot;)) +
  labs(title = expression(paste(&amp;quot;Total &amp;quot;, italic(N), &amp;quot; required for .8 power, based on variance ratio of 0.281&amp;quot;)),
       subtitle = expression(paste(&amp;quot;The power simulations only considered up to &amp;quot;, italic(N), &amp;quot; = 1,000.&amp;quot;)),
       x = expression(paste(&amp;quot;Cohen&amp;#39;s &amp;quot;, italic(d))),
       y = &amp;quot;% missing\nper follow-up&amp;quot;) +
  theme(axis.ticks = element_blank(),
        panel.grid = element_blank())&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2021-07-02-example-power-analysis-report/index_files/figure-html/unnamed-chunk-13-1.png&#34; width=&#34;624&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Again, I recommend playing it safe and relying on the power estimates based on the larger variance ratio of 0.281. Those power curves indicate that even with rather large dropout (i.e., 30% at the second time point and another 30% at the final time point), &lt;span class=&#34;math inline&#34;&gt;\(N = 486\)&lt;/span&gt; is sufficient to detect a small effect size (i.e., &lt;span class=&#34;math inline&#34;&gt;\(d = 0.2\)&lt;/span&gt;) at the conventional .8 power threshold. Note that because we cut off the power simulations at &lt;span class=&#34;math inline&#34;&gt;\(N = 1{,}000\)&lt;/span&gt;, we never reached .8 power in the conditions where &lt;span class=&#34;math inline&#34;&gt;\(d = 0.1\)&lt;/span&gt; and there was missingness at or greater than 0% dropout at each follow-up time point.&lt;/p&gt;
&lt;p&gt;To clarify, &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt; in each cell is the total sample size presuming both the control and experimental conditions have equal numbers in each. Thus, &lt;span class=&#34;math inline&#34;&gt;\(n_\text{control} = n_\text{experimental} = N/2\)&lt;/span&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;wrap-up&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Wrap up&lt;/h2&gt;
&lt;p&gt;I presented the original report with an HTML document, which used the R Markdown &lt;a href=&#34;https://community.rstudio.com/t/notebook-with-code-folding-hide-by-default/55845&#34;&gt;code folding&lt;/a&gt; option, which hid my code, by default. Since I’m not aware of a good way to use code folding with &lt;strong&gt;blogdown&lt;/strong&gt; blog posts, here you see the code in all its glory.&lt;/p&gt;
&lt;p&gt;All you Bayesian freaks may have noticed that this was a conventional frequentist power analysis. I’m not always a Bayesian. 🤷 When you intend to analyze experimental RCT-like data with frequentist software, the &lt;a href=&#34;https://github.com/rpsychologist/powerlmm&#34;&gt;&lt;strong&gt;powerlmm&lt;/strong&gt; package&lt;/a&gt; &lt;span class=&#34;citation&#34;&gt;(&lt;a href=&#34;#ref-R-powerlmm&#34; role=&#34;doc-biblioref&#34;&gt;Magnusson, 2018&lt;/a&gt;)&lt;/span&gt; can come in really handy.&lt;/p&gt;
&lt;p&gt;Had I intended to share a report like this for a broader audience, possibly as supplemental material for a paper, I might have explained the &lt;strong&gt;powerlmm&lt;/strong&gt; code a bit more. Since this was originally meant for internal use, my main goal was to present the results with an extra bit of transparency for the sake of building trust with a new collaborator. It worked, by the way. This person’s grant money now pays for part of my salary.&lt;/p&gt;
&lt;p&gt;If this was supplementary material, I would have also spent more time explicitly showing where I got the Cohen’s &lt;span class=&#34;math inline&#34;&gt;\(d\)&lt;/span&gt;, ICC, and variance ratio values.&lt;/p&gt;
&lt;p&gt;If you didn’t notice, the context for this power analysis wasn’t ideal. Even though I pulled information from two different data sources, neither was ideal and their combination wasn’t, either. Though my collaborator’s pilot data let me compute the Cohen’s &lt;span class=&#34;math inline&#34;&gt;\(d\)&lt;/span&gt; and the ICC, I didn’t have access to the raw data, themselves. Without that, I had no good way to compute the variance ratio. As it turns out, that was a big deal. Though I was able to compute variance ratios from different data from a similar population, it wasn’t on the same criterion variable. The best place to be in is if you have pilot data from the same population and on the same criterion variable. Outside of that, you’re making assumptions about model parameters you might not have spent a lot of time pondering, before. Welcome to the world of multilevel power analyses, friends. Keep your chins up. It’s rough, out there.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;session-info&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Session info&lt;/h2&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;sessionInfo()&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## R version 4.0.4 (2021-02-15)
## Platform: x86_64-apple-darwin17.0 (64-bit)
## Running under: macOS Catalina 10.15.7
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRblas.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] forcats_0.5.1   stringr_1.4.0   dplyr_1.0.6     purrr_0.3.4    
## [5] readr_1.4.0     tidyr_1.1.3     tibble_3.1.2    ggplot2_3.3.3  
## [9] tidyverse_1.3.0
## 
## loaded via a namespace (and not attached):
##  [1] tidyselect_1.1.1  xfun_0.23         bslib_0.2.4       haven_2.3.1      
##  [5] colorspace_2.0-0  vctrs_0.3.8       generics_0.1.0    viridisLite_0.4.0
##  [9] htmltools_0.5.1.1 emo_0.0.0.9000    yaml_2.2.1        utf8_1.2.1       
## [13] rlang_0.4.11      jquerylib_0.1.4   pillar_1.6.1      withr_2.4.2      
## [17] glue_1.4.2        DBI_1.1.0         dbplyr_2.0.0      modelr_0.1.8     
## [21] readxl_1.3.1      lifecycle_1.0.0   munsell_0.5.0     blogdown_1.3     
## [25] gtable_0.3.0      cellranger_1.1.0  rvest_0.3.6       evaluate_0.14    
## [29] labeling_0.4.2    knitr_1.33        MBESS_4.8.0       fansi_0.4.2      
## [33] highr_0.9         broom_0.7.6       Rcpp_1.0.6        backports_1.2.1  
## [37] scales_1.1.1      jsonlite_1.7.2    farver_2.1.0      fs_1.5.0         
## [41] hms_0.5.3         digest_0.6.27     stringi_1.6.2     bookdown_0.22    
## [45] grid_4.0.4        cli_2.5.0         tools_4.0.4       magrittr_2.0.1   
## [49] sass_0.3.1        crayon_1.4.1      pkgconfig_2.0.3   ellipsis_0.3.2   
## [53] xml2_1.3.2        reprex_0.3.0      lubridate_1.7.9.2 rstudioapi_0.13  
## [57] assertthat_0.2.1  rmarkdown_2.8     httr_1.4.2        R6_2.5.0         
## [61] compiler_4.0.4&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div id=&#34;references&#34; class=&#34;section level2 unnumbered&#34;&gt;
&lt;h2&gt;References&lt;/h2&gt;
&lt;div id=&#34;refs&#34; class=&#34;references csl-bib-body hanging-indent&#34; line-spacing=&#34;2&#34;&gt;
&lt;div id=&#34;ref-R-powerlmm&#34; class=&#34;csl-entry&#34;&gt;
Magnusson, K. (2018). &lt;em&gt;&lt;span class=&#34;nocase&#34;&gt;powerlmm&lt;/span&gt;: &lt;span&gt;Power&lt;/span&gt; analysis for longitudinal multilevel models&lt;/em&gt; [Manual]. &lt;a href=&#34;https://github.com/rpsychologist/powerlmm&#34;&gt;https://github.com/rpsychologist/powerlmm&lt;/a&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
</description>
    </item>
    
  </channel>
</rss>
